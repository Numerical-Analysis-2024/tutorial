
<!DOCTYPE html>


<html lang="es" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Manejo de vectores y matrices en Python: Módulo NumPy Parte 2 &#8212; Repaso de Análisis y Modelamiento Numérico I</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="../_static/documentation_options.js?v=78d55cf8"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../_static/translations.js?v=efdbd0b9"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'intro_python/numpy_b';</script>
    <link rel="index" title="Índice" href="../genindex.html" />
    <link rel="search" title="Búsqueda" href="../search.html" />
    <link rel="next" title="Álgebra Lineal" href="linear_algebra.html" />
    <link rel="prev" title="Manejo de vectores y matrices en Python: Módulo Numpy Parte 1" href="numpy_a.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="es"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Saltar al contenido principal</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Volver arriba</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.jpg" class="logo__image only-light" alt="Repaso de Análisis y Modelamiento Numérico I - Home"/>
    <script>document.write(`<img src="../_static/logo.jpg" class="logo__image only-dark" alt="Repaso de Análisis y Modelamiento Numérico I - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Búsqueda" aria-label="Búsqueda" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Búsqueda</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Repaso de Análisis Numérico I 2024
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introducción a Python, NumPy y Matplotlib</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="python.html">Introducción a la programación en lenguaje Python</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="numpy_a.html">Manejo de vectores y matrices en Python: Módulo Numpy Parte 1</a></li>

<li class="toctree-l2 current active"><a class="current reference internal" href="#">Manejo de vectores y matrices en Python: Módulo NumPy Parte 2</a></li>

<li class="toctree-l2"><a class="reference internal" href="linear_algebra.html">Álgebra Lineal</a></li>
<li class="toctree-l2"><a class="reference internal" href="eigenvalues.html">Ecuaciones Diferenciales Ordinarias</a></li>
<li class="toctree-l2"><a class="reference internal" href="lorenz.html">Sistema de Lorenz</a></li>
<li class="toctree-l2"><a class="reference internal" href="heat.html">Ecuación de calor</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Numéros de máquina, cambio de base</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../binario.html">Tutorial binario</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Sistemas de ecuaciones lineales</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../lu.html">Factorización LU</a></li>
<li class="toctree-l1"><a class="reference internal" href="../special.html">Sistemas de Ecuaciones Lineales Especiales</a></li>
<li class="toctree-l1"><a class="reference internal" href="../norms.html">Normas</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/Numerical-Analysis-2024/tutorial" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Repositorio de origen"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/Numerical-Analysis-2024/tutorial/issues/new?title=Issue%20on%20page%20%2Fintro_python/numpy_b.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Abrir un problema"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Descarga esta pagina">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/intro_python/numpy_b.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Descargar archivo fuente"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Imprimir en PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Modo de pantalla completa"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="claro/oscuro" aria-label="claro/oscuro" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Búsqueda" aria-label="Búsqueda" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Manejo de vectores y matrices en Python: Módulo NumPy Parte 2</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contenido </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Manejo de vectores y matrices en Python: Módulo NumPy Parte 2</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generando-matrices">Generando Matrices</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vistas-de-vectores">Vistas de vectores</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#indexacion-avanzada">Indexación avanzada</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reconfiguracion-y-redimensionalizacion-de-vectores">Reconfiguración y redimensionalización de vectores</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vectorizacion-de-funciones-y-operadores">Vectorización de funciones y operadores</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ejemplo-1-infiltracion-de-agua-en-el-suelo">Ejemplo #1: Infiltración de Agua en el suelo.</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ejercicios-de-la-clase">Ejercicios de la clase</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ejercicio-1-calculando-funcion-en-3d">Ejercicio #1: Calculando función en 3D.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ejercicio-2">Ejercicio #2:</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="manejo-de-vectores-y-matrices-en-python-modulo-numpy-parte-2">
<h1>Manejo de vectores y matrices en Python: Módulo NumPy Parte 2<a class="headerlink" href="#manejo-de-vectores-y-matrices-en-python-modulo-numpy-parte-2" title="Link to this heading">#</a></h1>
<p><img alt="numpy_img.png" src="https://raw.githubusercontent.com/numpy/numpy/main/branding/logo/primary/numpylogodark.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">matplotlib.cm</span> <span class="k">as</span> <span class="nn">cm</span>

<span class="c1"># Módulos para representación gráfica en 3D</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Creando matriz de prueba A</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Módulo para análisis simbólico</span>
<span class="c1"># (En este código se utiliza para representar las matrices)</span>
<span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sy</span>

<span class="c1"># Ploteo de soluciones</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>

<span class="c1"># Matrices sparse</span>
<span class="c1"># Módulo de scipy que permite trabajo con matrices sparse</span>
<span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <span class="n">spdiags</span>
<span class="kn">from</span> <span class="nn">scipy.sparse.linalg</span> <span class="kn">import</span> <span class="n">spsolve</span>
</pre></div>
</div>
</div>
</div>
<section id="generando-matrices">
<h2>Generando Matrices<a class="headerlink" href="#generando-matrices" title="Link to this heading">#</a></h2>
<p>Las matrices en Python numérico pueden ser representadas de varias formas.
Una de ellas es mediante el uso de vectores 2-dimensionales o <code class="docutils literal notranslate"><span class="pre">2darray</span></code>.
Más adelante se mostrará otra estructura de dato para representarlas.
Seguidamente se brindan algunos ejemplos de cómo generar matrices con vectores bidimensionales.</p>
<p>Generar la matriz identidad</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ident</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;El tipo es:&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">ident</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ident</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>El tipo es: &lt;class &#39;numpy.ndarray&#39;&gt;
[[1. 0. 0. 0.]
 [0. 1. 0. 0.]
 [0. 0. 1. 0.]
 [0. 0. 0. 1.]]
</pre></div>
</div>
</div>
</div>
<p>Generando matrices que poseen <span class="math notranslate nohighlight">\(1\)</span>’s en una de sus diagonales.
El parámetro <code class="docutils literal notranslate"><span class="pre">k</span></code> representa la posición de la diagonal seleccionada.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uno_sup</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Seleccionar la diagonal superior a la diagonal principal</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Diagonal superior:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">uno_sup</span><span class="p">)</span>

<span class="n">uno_inf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Seleccionar la diagonal inferior a la diagonal principal</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Diagonal inferior:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">uno_inf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Diagonal superior:
 [[0. 1. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 1. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
Diagonal inferior:
 [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 1. 0.]]
</pre></div>
</div>
</div>
</div>
<p>Una forma más general de generar una matriz diagonal es usando la función <code class="docutils literal notranslate"><span class="pre">np.diag</span></code>.
Esta permite especificar cada uno de los elementos de la diagonal y su posición con respecto a la diagonal principal con el parámetro <code class="docutils literal notranslate"><span class="pre">k</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">diag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">diag</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0 1 0 0 0 0 0 0 0]
 [0 0 4 0 0 0 0 0 0]
 [0 0 0 1 0 0 0 0 0]
 [0 0 0 0 4 0 0 0 0]
 [0 0 0 0 0 1 0 0 0]
 [0 0 0 0 0 0 4 0 0]
 [0 0 0 0 0 0 0 1 0]
 [0 0 0 0 0 0 0 0 4]
 [0 0 0 0 0 0 0 0 0]]
</pre></div>
</div>
</div>
</div>
<p>El proceso inverso es también posible, obtener un vector con los valores de
una diagonal de la matriz considerando su desplazamiento.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diagonal</span><span class="p">(</span><span class="n">diag</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1 4 1 4 1 4 1 4]
</pre></div>
</div>
</div>
</div>
<p>Otras funciones útiles ya se encuentran diseñadas en la biblioteca NumPy para
obtener información de los elementos de una matriz evitando ciclos explícitos en Python.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">35</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">41</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">45</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">51</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">55</span><span class="p">],</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Matriz_ej:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Matriz_ej:
 [[11 12 13 14 15]
 [21 22 23 24 25]
 [31 32 33 34 35]
 [41 42 43 44 45]
 [51 52 53 54 55]]
</pre></div>
</div>
</div>
</div>
<p>Un ejemplo de ello es la traza de la matriz la cual suma los elementos de la diagonal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Suma de la diagonal principal:&quot;</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">trace</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Suma de la diagonal principal: 165
</pre></div>
</div>
</div>
</div>
<p>También se pueden citar otros dos ejemplos, <code class="docutils literal notranslate"><span class="pre">triu</span></code> y <code class="docutils literal notranslate"><span class="pre">tril</span></code>.
La primera devuelve la correspondiente matriz triangular superior.
La segunda devuelve la correspondiente matriz triangular inferior.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[11, 12, 13, 14, 15],
       [ 0, 22, 23, 24, 25],
       [ 0,  0, 33, 34, 35],
       [ 0,  0,  0, 44, 45],
       [ 0,  0,  0,  0, 55]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">tril</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[11,  0,  0,  0,  0],
       [21, 22,  0,  0,  0],
       [31, 32, 33,  0,  0],
       [41, 42, 43, 44,  0],
       [51, 52, 53, 54, 55]])
</pre></div>
</div>
</div>
</div>
<section id="vistas-de-vectores">
<h3>Vistas de vectores<a class="headerlink" href="#vistas-de-vectores" title="Link to this heading">#</a></h3>
<p>Al realizar una selección en un vector el resultado no se almacena en un nuevo vector directamente,
sino que se crea una vista del vector.
Esto significa que en la memoria los elementos de la nueva selección son exactamente los elementos
seleccionados del vector y no se ocupa memoria adicional.
Por tal motivo, si se modifica alguno de ellos en una vista entonces se modificarán en el propio
vector también.
En otras palabras, la vista es una estructura lógica que contiene una configuración diferente de los
elementos del vector al que apunta.
Por ejemplo:</p>
<p>Creemos una matriz usando un listado de números y la operación <code class="docutils literal notranslate"><span class="pre">np.reshape</span></code> la cual
realiza un cambio de tamaño de las dimensiones de los elementos
(esta función será explicada más adelante).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># La secuencia [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25]</span>
<span class="c1"># es reconfigurada en una matriz de 5 x 5 elementos.</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1,  2,  3,  4,  5],
       [ 6,  7,  8,  9, 10],
       [11, 12, 13, 14, 15],
       [16, 17, 18, 19, 20],
       [21, 22, 23, 24, 25]])
</pre></div>
</div>
</div>
</div>
<p>Realicemos una selección de la submatriz (vista) comprendida entre <span class="math notranslate nohighlight">\(1\leq i\leq 3\)</span> y <span class="math notranslate nohighlight">\(1\leq j\leq 3\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
<span class="n">B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 7,  8,  9],
       [12, 13, 14],
       [17, 18, 19]])
</pre></div>
</div>
</div>
</div>
<p>Asignemos el valor <span class="math notranslate nohighlight">\(0\)</span> a cada elemento de la vista <span class="math notranslate nohighlight">\(B\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="p">[:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0, 0, 0],
       [0, 0, 0],
       [0, 0, 0]])
</pre></div>
</div>
</div>
</div>
<p>Entonces la matriz <span class="math notranslate nohighlight">\(A\)</span> tendrá los <span class="math notranslate nohighlight">\(0\)</span>’s en los valores seleccionados por la vista.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1,  2,  3,  4,  5],
       [ 6,  0,  0,  0, 10],
       [11,  0,  0,  0, 15],
       [16,  0,  0,  0, 20],
       [21, 22, 23, 24, 25]])
</pre></div>
</div>
</div>
</div>
<p>¿Cuál es la diferencia entre escribir <code class="docutils literal notranslate"><span class="pre">B[:,</span> <span class="pre">:]</span> <span class="pre">=</span> <span class="pre">0</span></code> y <code class="docutils literal notranslate"><span class="pre">B=0</span></code>?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># B = 0</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;B:&quot;</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tipo de B:&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">B</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A:&quot;</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>B: [[0 0 0]
 [0 0 0]
 [0 0 0]]
Tipo de B: &lt;class &#39;numpy.ndarray&#39;&gt;
A: [[ 1  2  3  4  5]
 [ 6  0  0  0 10]
 [11  0  0  0 15]
 [16  0  0  0 20]
 [21 22 23 24 25]]
</pre></div>
</div>
</div>
</div>
<p>Ahora, cómo se puede crear una nueva matriz a partir de la vista resultado de una selección.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="n">C</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0, 0, 0],
       [0, 0, 0],
       [0, 0, 0]])
</pre></div>
</div>
</div>
</div>
<p>Comprobando volvemos a crear la matriz A y ejecutamos nuevamente la vista. Luego asignamos a la vista B el valor 0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>

<span class="n">B</span><span class="p">[:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;B:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;C:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A:
 [[ 1  2  3  4  5]
 [ 6  0  0  0 10]
 [11  0  0  0 15]
 [16  0  0  0 20]
 [21 22 23 24 25]]
B:
 [[0 0 0]
 [0 0 0]
 [0 0 0]]
C:
 [[0 0 0]
 [0 0 0]
 [0 0 0]]
</pre></div>
</div>
</div>
</div>
<p>¿Si quisiera volver a restaurar los datos anulados de <span class="math notranslate nohighlight">\(A\)</span> utilizando la información de <span class="math notranslate nohighlight">\(C\)</span> qué podría hacer?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span><span class="p">[:,</span> <span class="p">:]</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1,  2,  3,  4,  5],
       [ 6,  0,  0,  0, 10],
       [11,  0,  0,  0, 15],
       [16,  0,  0,  0, 20],
       [21, 22, 23, 24, 25]])
</pre></div>
</div>
</div>
</div>
<p>¿La siguiente línea de código también funcionará de la misma manera?
¿Lanzará algún error?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1,  2,  3,  4,  5],
       [ 6,  0,  0,  0, 10],
       [11,  0,  0,  0, 15],
       [16,  0,  0,  0, 20],
       [21, 22, 23, 24, 25]])
</pre></div>
</div>
</div>
</div>
<p>La operación de asignación <code class="docutils literal notranslate"><span class="pre">=</span></code> se ha redefinido en la biblioteca NumPy.
¿Qué pasaría si ahora se modifica uno de los valores de la matriz <span class="math notranslate nohighlight">\(C\)</span>?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">C</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0, 0, 0],
       [0, 0, 0],
       [0, 0, 0]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">C</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;C:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A:
 [[ 1  2  3  4  5]
 [ 6  0  0  0 10]
 [11  0  0  0 15]
 [16  0  0  0 20]
 [21 22 23 24 25]]
C:
 [[  0   0   0]
 [  0   0   0]
 [  0   0 100]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="indexacion-avanzada">
<h3>Indexación avanzada<a class="headerlink" href="#indexacion-avanzada" title="Link to this heading">#</a></h3>
<p>Hasta el momento la selección se ha ido realizando especificando números e intervalos
en las expresiones de selección para cada una de las dimensiones, pero existen otras formas
más avanzadas de seleccionar elementos las cuales mostraremos en esta sección.</p>
<p>Es posible realizar selección de índices previamente especificados en una secuencia
(lista, tupla, vector, etc.).
Veamos un ejemplo.
Supongamos que se quieren seleccionar los elementos con los índices <span class="math notranslate nohighlight">\(0\)</span>, <span class="math notranslate nohighlight">\(2\)</span> y <span class="math notranslate nohighlight">\(4\)</span> de un vector</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">vec</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10])
</pre></div>
</div>
</div>
</div>
<p>El vector de índices de interés es</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">idx</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0, 2, 4])
</pre></div>
</div>
</div>
</div>
<p>Luego la selección se realiza al pasar en el operador de selección <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">]</span></code> la secuencia de índices</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vec</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1, 3, 5])
</pre></div>
</div>
</div>
</div>
<p>Lo mismo puede ser llevado a cabo con una lista</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vec</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1, 3, 5])
</pre></div>
</div>
</div>
</div>
<p>Otra de las variantes de selección es la selección condicional.
En este caso se puede establecer una condición booleana la cual es
evaluada en cada uno de los elementos del vector, retornando un vector de
valores booleanos con cada uno de los resultados de la evaluación en sus
correspondientes índices.</p>
<p>Por ejemplo, supongamos que del vector <code class="docutils literal notranslate"><span class="pre">vec</span></code> quisiera saber cuáles son los elementos mayores que <span class="math notranslate nohighlight">\(5\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vec</span> <span class="o">&gt;</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([False, False, False, False, False,  True,  True,  True,  True,
        True])
</pre></div>
</div>
</div>
</div>
<p>Ahora combinando con lo explicado en <a class="reference external" href="https://colab.research.google.com/drive/1d5T9fcnaIvKOELRXUNE2PjVKHMVdmdeA#scrollTo=NJnTswBB9SDS&amp;amp;line=1&amp;amp;uniqifier=1">146</a> se obtienen solo aquellos valores para los que la condición fue verdadera, aquellos mayores que 5.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vec</span><span class="p">[</span><span class="n">vec</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 6,  7,  8,  9, 10])
</pre></div>
</div>
</div>
</div>
<p>En este caso, es importante aclarar que la indexación avanzada <strong>NO</strong> es una vista.
Al asignar el resultado de la indexación avanzada a una nueva variable esta creará
un nuevo vector con su propio espacio reservado en memoria.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">vec</span><span class="p">[</span><span class="n">vec</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">A</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;vec:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">vec</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A:
 [-1  7  8  9 -1]
vec:
 [ 1  2  3  4  5  6  7  8  9 10]
</pre></div>
</div>
</div>
</div>
<p>Pero a su vez es posible hacer cambios en el vector <code class="docutils literal notranslate"><span class="pre">vec</span></code> usando indexación avanzada.
Véase el siguiente ejemplo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vec</span><span class="p">[[</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;vec:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">vec</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>vec:
 [ 1  2  3  4  5 -1  7  8  9 -1]
</pre></div>
</div>
</div>
</div>
<p>O también para indexación condicional:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vec</span><span class="p">[</span><span class="n">vec</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;vec:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">vec</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>vec:
 [ 1  2  3  4  5 -1 -1 -1 -1 -1]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="reconfiguracion-y-redimensionalizacion-de-vectores">
<h2>Reconfiguración y redimensionalización de vectores<a class="headerlink" href="#reconfiguracion-y-redimensionalizacion-de-vectores" title="Link to this heading">#</a></h2>
<p>Una situación muy usual cuando se trabaja con vectores y matrices es la reconfiguración de la
disposición de sus elementos o la redimensionalización de sus dimensiones.
Por ejemplo, un vector bidimenional de <span class="math notranslate nohighlight">\(N\times N\)</span> pudiera ser redimensionado en uno vector
unidimensional de <span class="math notranslate nohighlight">\(N^2\)</span> o pudiera ser reconfigurado uniendo varios vectores o apilándolos
vertical u horizontalmente.
La biblioteca NumPy brinda un amplio listado de funciones para manipular vectores.</p>
<p>Resumen de funciones para manipular vectores</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Función</p></th>
<th class="head"><p>Descripción</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.reshape</span></code></p></td>
<td><p>Redimensiona el array manteniendo la misma cantidad de elementos. Esto indica que <span class="math notranslate nohighlight">\(i * j = n\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.flatten</span></code></p></td>
<td><p>Crea un vector unidimensional a partir de un vector n-dimensional. Dicho de otra forma, la posición en el vector unidimensional del elemento <code class="docutils literal notranslate"><span class="pre">nd-vec</span></code><span class="math notranslate nohighlight">\([k_{d1}, k_{d2}, \dots, k_{dN}]\)</span> = <code class="docutils literal notranslate"><span class="pre">1d-vec</span></code><span class="math notranslate nohighlight">\([k_{d1} + \sum\limits_{r=2}^N k_{dr} N_r]\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.ravel</span></code></p></td>
<td><p>Crea una vista unidimensional de un vector n-dimensional siempre que sea posible. De otra forma crea un nuevo vector. La indexación ocurre de igual forma que en <code class="docutils literal notranslate"><span class="pre">np.flatten</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.transpose</span></code></p></td>
<td><p>Devuelve la transpuesta de un vector bidimensional.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.hstack</span></code></p></td>
<td><p>Apila (en la dimensión 1) una lista de vectores de forma horizontal, de izquierda a derecha. Devuelve una matriz con los mismos apilados</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.vstack</span></code></p></td>
<td><p>Apila (en la dimensión 0) una lista de vectores de forma vertical, de arriba hacia abajo.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.concatenate</span></code></p></td>
<td><p>Crea un nuevo vector que es la concatenación de un listado de vectores. *<em>Es muy utilizado en conformación de matrices en PDEs solvers</em>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.resize</span></code></p></td>
<td><p>Crea un nuevo vector como el original pero con dimensiones de tamaño diferente. Si el tamaño es mayor que el del vector original entonces los elementos sobrantes serán rellenados con los elementos del vector original siguiendo el mismo orden y comenzando desde el primero. *<em>Esta también es muy útil en la conformación de matrices sobre todo en PDEs solvers de dimensión mayor que 1</em>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.append</span></code></p></td>
<td><p>Crea un <strong>nuevo</strong> vector con un elemento adicionado al final. <strong>Esta operación es computacionalmente costosa</strong> por lo que debe evitarse.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.insert</span></code></p></td>
<td><p>Crea un <strong>nuevo</strong> vector con un elemento insertado en una posición determinada. <strong>Esta operación es computacionalmente costosa</strong> por lo que debe evitarse.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.delete</span></code></p></td>
<td><p>Crea un <strong>nuevo</strong> vector eliminando uno de los elementos del vector original. <strong>Esta operación es computacionalmente costosa</strong> por lo que debe evitarse.</p></td>
</tr>
</tbody>
</table>
</div>
<p>Veamos algunos ejemplos del uso de estas funciones.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">B</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0]])
</pre></div>
</div>
</div>
</div>
<section id="vectorizacion-de-funciones-y-operadores">
<h3>Vectorización de funciones y operadores<a class="headerlink" href="#vectorizacion-de-funciones-y-operadores" title="Link to this heading">#</a></h3>
<p>El sentido de utilizar esta clase <code class="docutils literal notranslate"><span class="pre">ndArray</span></code> es poder utilizar las operaciones vectoriales
que ejecutan rutinas eficientes para los elementos del vector que están implementadas a
bajo nivel.</p>
<p>Por ejemplo, considérese la siguiente operación suma entre dos elementos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">suma</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</pre></div>
</div>
</div>
</div>
<p>Si se utiliza para sumar dos elementos funciona de acuerdo a lo esperado:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">suma</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5
</pre></div>
</div>
</div>
</div>
<p>Pero si se desea ejecutar sobre cada par correspondiente de elementos de una lista, entonces se esperaría que sume cada par de números correspondientes, uno de una y el otro de la otra. Pero el resultado no es el esperado:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">suma</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, 3, 3, 2, 1]
</pre></div>
</div>
</div>
</div>
<p>En efecto, las estructuras de datos utilizadas son listas por lo que la operación
<code class="docutils literal notranslate"><span class="pre">+</span></code> está definida como una unión entre listas de elementos.</p>
<p>Veamos el ejemplo de una función que dada la comparación entre <span class="math notranslate nohighlight">\(a\)</span> y <span class="math notranslate nohighlight">\(b\)</span> decide sumarlos o restarlos.
(Tomado de la documentación de NumPy)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="s2">&quot;Return a-b if a&gt;b, otherwise return a+b&quot;</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="n">b</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
</pre></div>
</div>
</div>
</div>
<p>Este es un caso bien sencillo para el caso en el que no ha sido vectorizado:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1 &lt; 4 =&gt;&quot;</span><span class="p">,</span> <span class="n">fun</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;4 &gt; 2 =&gt;&quot;</span><span class="p">,</span> <span class="n">fun</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 &lt; 4 =&gt; 5
4 &gt; 2 =&gt; 2
</pre></div>
</div>
</div>
</div>
<p>¿Pero qué sucederá si se vectoriza esta función?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_fun</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">fun</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Veamos el resultado del mismo ejemplo anterior pero esta vez con la versión vectorizada:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1 &lt; 4 =&gt;&quot;</span><span class="p">,</span> <span class="n">_fun</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;4 &gt; 2 =&gt;&quot;</span><span class="p">,</span> <span class="n">_fun</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 &lt; 4 =&gt; 5
4 &gt; 2 =&gt; 2
</pre></div>
</div>
</div>
</div>
<p>La función <code class="docutils literal notranslate"><span class="pre">np.vectorize</span></code> es una herramienta para «convertir» estas funciones
en expresiones que utilicen las ventajas de los <code class="docutils literal notranslate"><span class="pre">ndarrays</span></code>.</p>
<p>El resultado del ejemplo anterior es exactamente el mismo resultado obtenido para
el caso no vectorizado, pero que pasa si extendemos los parámetros de entrada a secuencias de números:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">_fun</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([3, 4, 1, 2])
</pre></div>
</div>
</div>
</div>
<p>En este caso la operación definida en la función fue vectorizada y repetida por cada elemento de <code class="docutils literal notranslate"><span class="pre">a</span></code>.</p>
<p>¿Pero qué sucederá si también <code class="docutils literal notranslate"><span class="pre">b</span></code> es un listado de números (misma longitud que <code class="docutils literal notranslate"><span class="pre">a</span></code>)?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">_fun</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([3, 1, 3, 3])
</pre></div>
</div>
</div>
</div>
<p>Efectivamente, se ejecutó la operación definida en <code class="docutils literal notranslate"><span class="pre">fun</span></code> para cada par correspondiente de elementos de <code class="docutils literal notranslate"><span class="pre">a</span></code> y <code class="docutils literal notranslate"><span class="pre">b</span></code> resultando en un nuevo array con el resultado de cada operación en su índice correspondiente:</p>
<p>Este es precisamente el concepto que se encuentra detrás de las operaciones vectorizadas que ya se encuentran implementadas en NumPy.</p>
<p>Entre ellas se encuentran las operaciones aritméticas entre los operandos <code class="docutils literal notranslate"><span class="pre">a</span></code> y <code class="docutils literal notranslate"><span class="pre">b</span></code>, vector-escalar y vector-vector:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Operators</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>+, -, *, /, **</p></td>
<td><p>Operadores suma, resta, multiplicación división y potencia los cuales operan sobre cada par de operandos correspondientes de la forma <span class="math notranslate nohighlight">\(c_{i}=a_{i}\)</span> o <span class="math notranslate nohighlight">\(b_{i}, i=0,1,\dots,len(c)\)</span> (para la potencia sería <span class="math notranslate nohighlight">\(c_{i} = {a_i}^{b_i}\)</span>).</p></td>
</tr>
</tbody>
</table>
</div>
<p>Pero NumPy implementa una gran cantidad de funciones vectoriales.
A continuación listo una selección resumen de las mismas:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>función</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.sin</span></code>, <code class="docutils literal notranslate"><span class="pre">np.cos</span></code>, <code class="docutils literal notranslate"><span class="pre">np.tan</span></code></p></td>
<td><p>Funciones trigonométricas.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.arcsin</span></code>, <code class="docutils literal notranslate"><span class="pre">np.arccos</span></code>, <code class="docutils literal notranslate"><span class="pre">np.arctan</span></code></p></td>
<td><p>Funciones trigonométricas inversas.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.sqrt</span></code></p></td>
<td><p>Raíz cuadrada.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.exp</span></code></p></td>
<td><p>Función exponencial.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.log</span></code>, <code class="docutils literal notranslate"><span class="pre">np.log2</span></code>, <code class="docutils literal notranslate"><span class="pre">np.log10</span></code></p></td>
<td><p>Función logaritmo de base <span class="math notranslate nohighlight">\(e\)</span>, <span class="math notranslate nohighlight">\(2\)</span> y <span class="math notranslate nohighlight">\(10\)</span> respectivamente.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.remainder</span></code></p></td>
<td><p>Calcula el resto de la división entre dos arrays.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.reciprocal</span></code></p></td>
<td><p>Calcula el número recíproco de los números.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.sign</span></code></p></td>
<td><p>Devuelve el signo del número (<span class="math notranslate nohighlight">\(+, -\)</span>).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.abs</span></code></p></td>
<td><p>Calcula el valor absoluto de cada número.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.floor</span></code></p></td>
<td><p>Devuelve el valor <span class="math notranslate nohighlight">\(x_{floor} = \lfloor x\rfloor\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.ceil</span></code></p></td>
<td><p>Devuelve el valor <span class="math notranslate nohighlight">\(x_{ceil} = \lceil x \rceil\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.rint</span></code></p></td>
<td><p>Redondea por defecto el número de punto flotante a su entero más cercano de la siguiente manera: <span class="math notranslate nohighlight">\(x = \begin{cases} \lfloor x \rfloor ,&amp; \lfloor x \rfloor \geq x -\frac{1}{2} \\ \lceil x \rceil ,&amp; \lfloor x \rfloor \le x -\frac{1}{2}\end{cases}\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.round</span></code></p></td>
<td><p>Redondea un número de punto flotante a un cierto número de decimales.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="ejemplo-1-infiltracion-de-agua-en-el-suelo">
<h2>Ejemplo #1: Infiltración de Agua en el suelo.<a class="headerlink" href="#ejemplo-1-infiltracion-de-agua-en-el-suelo" title="Link to this heading">#</a></h2>
<img src="https://www.frontiersin.org/files/Articles/1258148/fmicb-14-1258148-HTML-r1/image_m/fmicb-14-1258148-g001.jpg" width=350 heigth=150>
<p>En este simple ejemplo se simulará la infiltración de agua en un acuífero confinado <em>hipotético</em>.
El mismo fue diseñado de forma como un área cuadrada que representa un corte vertical lateral,
impermeable en sus fronteras excepto la superior donde se define un flujo de agua entrante.</p>
<p>En la imagen se muestra una representación. Las líneas rojizas representan fronteras impermeables,
la verde representa la frontera de intercambio y las flechas azules el flujo dentro de la grava.</p>
<p>Para modelar este problema se utilizará la Ley de Darcy que se expresa en la siguiente ecuación
diferencial difusiva: <span class="math notranslate nohighlight">\(S_{s}\dfrac{\partial u}{\partial t}=K\Delta u\)</span>,
donde <span class="math notranslate nohighlight">\(u\)</span> representa la concentración de agua dentro del dominio, <span class="math notranslate nohighlight">\(K\)</span> es el coeficiente de conductividad
hidráulica y <span class="math notranslate nohighlight">\(S_{s}\)</span> es el almacenamiento específico del acuífero en cuestión.</p>
<p>En este caso el espesor del acuífero <span class="math notranslate nohighlight">\(\mu\)</span> será fijado en <span class="math notranslate nohighlight">\(1\)</span> metro y el coeficiente de
almacenamiento <span class="math notranslate nohighlight">\(S=5e-5\)</span> dado que es un suelo de gravilla.
Entonces se tiene <span class="math notranslate nohighlight">\(S_{s}=\frac{S}{\mu}\)</span>.</p>
<p>Luego, la conductividad hidráulica para ese tipo de suelo es <span class="math notranslate nohighlight">\(K=1e-1\)</span> <span class="math notranslate nohighlight">\(m/\text{días}\)</span> que llevándolo a
segundos es <span class="math notranslate nohighlight">\(K\approx 1.574e-6\)</span> <span class="math notranslate nohighlight">\(m/s\)</span>.</p>
<p>Replanteando la ecuación se obtiene que para el dominio <span class="math notranslate nohighlight">\(\Omega=\left\{\left(x,y\right)\mid x, y \in (0, N_x)\times (0, N_y)\right\}\)</span>
y tiempo <span class="math notranslate nohighlight">\(t\in\left[0, T\right)\)</span> se cumple <span class="math notranslate nohighlight">\(\dfrac{\partial u}{\partial t}-D\Delta u = 0\)</span>,
siendo <span class="math notranslate nohighlight">\(D=\frac{K \mu}{S}\)</span> el coeficiente de difusión en <span class="math notranslate nohighlight">\(m^2/s\)</span>.</p>
<p>Con respecto a las condiciones iniciales se considerará que no existe concentración de agua alguna en el dominio.
De esta forma <span class="math notranslate nohighlight">\(u\left(t=0, x, y\right)=0\)</span>, <span class="math notranslate nohighlight">\(\forall x,y\in\Omega\)</span>.</p>
<p>Con respecto a las condiciones de frontera:</p>
<ul class="simple">
<li><p>Fronteras impermeables: <span class="math notranslate nohighlight">\(\dfrac{\partial u(t &gt; 0, 0, y)}{\partial \vec{n}} = \dfrac{\partial u(t &gt; 0, N_x, y)}{\partial \vec{n}} = \dfrac{\partial u(t &gt; 0, x, 0)}{\partial \vec{n}} = 0, \,  ∀ x \in [0, N_x], ∀ y \in [0, N_y]\)</span></p></li>
<li><p>Frontera de intercambio: <span class="math notranslate nohighlight">\(\dfrac{\partial u(t &gt; 0, x, N_y)}{\partial \vec{n}} = D(u(x, N_y) - g(t &gt; 0, x)), \, ∀ x \in [1, N_x-1]\)</span>.</p></li>
</ul>
<p>Note que las primeras tres definiciones se clasifican como condiciones de frontera de Neumann homogéneas.
En el caso de la última, se clasifica como condición de frontera de Neumann, pero en este caso es heterogénea.
O sea, se ha definido un flujo en la misma el cual tiene una tasa de intercambio definida por el coeficiente
de difusión <span class="math notranslate nohighlight">\(D\)</span> y donde <span class="math notranslate nohighlight">\(g\)</span> representa el valor de la concentración en el exterior de la frontera.</p>
<p>Para resolver este problema numéricamente se utilizará un esquema de integración numérica explícito basado en diferencias finitas.</p>
<p>La discretización de las variables es como sigue:</p>
<ul class="simple">
<li><p>Tiempo: <span class="math notranslate nohighlight">\(t_{n}=n\Delta t, \, n=0, 1, \dots, T\)</span></p></li>
<li><p>Espacio: <span class="math notranslate nohighlight">\(x_{j}=j\Delta x, \, y_k = k \Delta y : j = 0, 1, \dots N_x\)</span>  y  <span class="math notranslate nohighlight">\(k = 0, 1, \dots, N_y\)</span></p></li>
</ul>
<p>En este caso por simplicidad asumiremos que <span class="math notranslate nohighlight">\(\Delta x = \Delta y\)</span> y <span class="math notranslate nohighlight">\(N_x = N_y\)</span>.</p>
<p>Se representa la discretización de los operadores diferenciales en el siguiente esquema en diferencias:</p>
<p><span class="math notranslate nohighlight">\(\dfrac{u^{n+1}_{j\,k} - u^{n}_{j\,k}}{\Delta t}-D\dfrac{u^n_{j-1\,k}-2 u^n_{j\,k}+u^n_{j+1\,k}}{\Delta x^2} - D\dfrac{u^n_{j\,k-1} - 2 u^n_{j\,k} + u^n_{j\,k+1}}{\Delta y^2} = 0\)</span>.</p>
<p>Es importante destacar que este esquema explícito (uno de los más simples) para que brinde soluciones estables debe de cumplir la siguiente condición CFL (Courant-Friedrichs-Levy):</p>
<p><span class="math notranslate nohighlight">\(D\frac{\Delta t}{\Delta x^2} + D\frac{\Delta t}{\Delta y^2} ≤ \frac{1}{2}\)</span></p>
<p>lo cual para nuestro problema significa</p>
<p><span class="math notranslate nohighlight">\(2 D \frac{\Delta t}{\Delta x^2} = 2 r \le \frac{1}{2}\)</span></p>
<p><span class="math notranslate nohighlight">\(r \le \frac{1}{4}\)</span>.</p>
<p>Por tal razón se fijó <span class="math notranslate nohighlight">\(r=0.2\)</span> y <span class="math notranslate nohighlight">\(\Delta x = 0.1\)</span> y se calcula el valor de <span class="math notranslate nohighlight">\(\Delta t\)</span> de manera que sea estable la solución:</p>
<p><span class="math notranslate nohighlight">\(\Delta t = \frac{r \Delta x^2}{D}\)</span>.</p>
<p>Para el caso de las condiciones de frontera se utilizó una aproximación de segundo orden (esquema en diferencias centradas) para calcular la derivada con respecto al vector normal en cada uno de los casos de condiciones de Neumann homogéneas.</p>
<p>En este caso, en la ecuación resultante se hallará una variable que se encuentra fuera de <span class="math notranslate nohighlight">\(\bar\Omega\)</span>. Para resolver este problema se asume que la ecuación de Laplace continúa siendo válida en la frontera (como de hecho lo es) y se elimina este término «<em>indeseable</em>».</p>
<p>Para el caso de la frontera con condiciones de Neumann heterogéneas, entonces se define el flujo y se sustituye en la ecuación de Laplace correspondiente dando lugar a un término no asociado a ninguna variable. Este será sumado al final de la operación.</p>
<p>El método puede finalmente plantearse de forma matricial de la siguiente manera: <span class="math notranslate nohighlight">\(u^{n+1}=\left(A+R\right)u^{n}+r\)</span>.</p>
<p>El vector de soluciones <span class="math notranslate nohighlight">\(u\)</span> está definido para <span class="math notranslate nohighlight">\(\bar{\Omega}\)</span> de la siguiente manera:</p>
<p><span class="math notranslate nohighlight">\(u^n = \begin{bmatrix}
u^n_{00} &amp; u^n_{01} &amp; \dots &amp; u^n_{0N_y} &amp; u^n_{10} &amp; u^n_{11} &amp; \dots &amp; u^n_{1N_y} &amp; \dots &amp; u^n_{N_x0} &amp; u^n_{N_x1} &amp; \dots &amp; u^n_{N_xN_y}
\end{bmatrix}^T\)</span>.</p>
<p>La matriz A es una matriz pentadiagonal de bloques.
La misma se puede explicar de la siguiente forma:</p>
<p><span class="math notranslate nohighlight">\(A = \begin{bmatrix}
B        &amp; 2 r I  &amp;   0    &amp;        &amp;        &amp; \dots  &amp; 0       \\
rI       &amp;   B    &amp;  rI    &amp; 0      &amp;        &amp; \dots  &amp; 0       \\
0        &amp;  rI    &amp;   B    &amp; rI     &amp;  0     &amp; \dots  &amp; 0       \\
\vdots   &amp; \ddots &amp; \ddots &amp; \ddots &amp; \ddots &amp; \ddots &amp; \vdots  \\
0        &amp; \dots  &amp;    0   &amp;    rI  &amp;   B    &amp;   rI   &amp;  0      \\
0        &amp; \dots  &amp;        &amp;    0   &amp;   rI   &amp;   B    &amp; rI      \\
0        &amp; \dots  &amp;        &amp;        &amp;   0    &amp;   2rI  &amp; B
\end{bmatrix}\)</span>,</p>
<p>donde <span class="math notranslate nohighlight">\(I\)</span> es la matriz identidad y <span class="math notranslate nohighlight">\(B\)</span> es una matriz tridiagonal definida así</p>
<p><span class="math notranslate nohighlight">\(B = \begin{bmatrix}
1 - 4r  &amp;   2r     &amp;          &amp;          &amp;        \\
r       &amp; 1 - 4r   &amp;   r      &amp;          &amp;        \\
        &amp;  \ddots  &amp; \ddots   &amp; \ddots   &amp;        \\
        &amp;          &amp;   r      &amp;  1 - 4r  &amp; r      \\
        &amp;          &amp;          &amp;    2r    &amp; 1 - 4r 
\end{bmatrix}\)</span>.</p>
<p>En el caso de la matriz R esta solo constará con el aporte que realiza la parte que calcula el flujo de intercamio asociada a las correspondientes variables <span class="math notranslate nohighlight">\(u^n_{j\, N_y}\)</span>.</p>
<p><span class="math notranslate nohighlight">\(R = \begin{bmatrix}
0 &amp;           &amp;              &amp;   &amp;        &amp;   &amp;              \\
  &amp; \ddots    &amp;              &amp;   &amp;        &amp;   &amp;              \\
  &amp;       &amp; 0 &amp;              &amp;   &amp;        &amp;   &amp;              \\
  &amp;       &amp;   &amp; 2r\Delta x D &amp;   &amp;        &amp;   &amp;              \\
  &amp;       &amp;   &amp;              &amp; 0 &amp;        &amp;   &amp;              \\
  &amp;       &amp;   &amp;              &amp;   &amp; \ddots &amp;   &amp;              \\
  &amp;       &amp;   &amp;              &amp;   &amp;        &amp; 0 &amp;              \\
  &amp;       &amp;   &amp;              &amp;   &amp;        &amp;   &amp; 2r\Delta x D
\end{bmatrix}\)</span></p>
<p>Para el otro término relacionado con el flujo se construye el siguiente vector:</p>
<p><span class="math notranslate nohighlight">\(r = \begin{bmatrix}
0                            \\
\vdots                       \\
0                            \\
2 r \Delta x D g^n_1         \\
0                            \\
\vdots                       \\
0                            \\
2 r \Delta x D g^n_2         \\
0                            \\
\vdots                       \\
0                            \\
2 r \Delta x D g^n_{N_x - 1} \\
0                            \\
\vdots                       \\
0
\end{bmatrix}\)</span></p>
<p>Comencemos el código de Python para resolver este problema. <em>Lo más importante a destacar en él es la conformación de las matrices y vectores utilizando la biblioteca numpy.</em></p>
<p>Creación de la matriz A que contiene los coeficientes de cada ecuación que describe el problema:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Creating_Matrix_A</span><span class="p">(</span><span class="n">Nx</span><span class="p">,</span> <span class="n">Ny</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
    <span class="c1"># Diagonal principal</span>
    <span class="n">diag0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">Nx</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">r</span><span class="p">),</span> <span class="n">Nx</span><span class="p">)</span>
    <span class="c1"># Diagonal principal superior</span>
    <span class="n">diag1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">r</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">Nx</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">r</span><span class="p">))),</span> <span class="n">Nx</span><span class="p">)</span>
    <span class="c1"># Diagonal principal inferior</span>
    <span class="n">diag_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">diag1</span><span class="p">)</span>

    <span class="c1"># Diagonal superior</span>
    <span class="n">diag_sup</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
        <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Nx</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">Nx</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">r</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">Nx</span><span class="p">,</span> <span class="n">r</span><span class="p">),</span> <span class="n">Nx</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span>
    <span class="p">)</span>
    <span class="c1"># Diagonal inferior</span>
    <span class="n">diag_inf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">diag_sup</span><span class="p">)</span>

    <span class="c1"># Retornando Matriz sparse</span>
    <span class="k">return</span> <span class="n">spdiags</span><span class="p">(</span>
        <span class="p">[</span><span class="n">diag_inf</span><span class="p">,</span> <span class="n">diag_1</span><span class="p">,</span> <span class="n">diag0</span><span class="p">,</span> <span class="n">diag1</span><span class="p">,</span> <span class="n">diag_sup</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="n">Nx</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Nx</span><span class="p">],</span>
        <span class="n">Nx</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">Ny</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">tocsr</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Visualicémosla a un nivel pequeño de <span class="math notranslate nohighlight">\(5X5\)</span> con la ayuda de la biblioteca Sympy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">Creating_Matrix_A</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Imprimiendo matriz de prueba A con Sympy</span>
<span class="n">Ap</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">todense</span><span class="p">())</span>
<span class="n">Ap</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}-1.0 &amp; 1.0 &amp; 0 &amp; 1.0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0.5 &amp; -1.0 &amp; 0.5 &amp; 0 &amp; 1.0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 1.0 &amp; -1.0 &amp; 0 &amp; 0 &amp; 1.0 &amp; 0 &amp; 0 &amp; 0\\0.5 &amp; 0 &amp; 0 &amp; -1.0 &amp; 1.0 &amp; 0 &amp; 0.5 &amp; 0 &amp; 0\\0 &amp; 0.5 &amp; 0 &amp; 0.5 &amp; -1.0 &amp; 0.5 &amp; 0 &amp; 0.5 &amp; 0\\0 &amp; 0 &amp; 0.5 &amp; 0 &amp; 1.0 &amp; -1.0 &amp; 0 &amp; 0 &amp; 0.5\\0 &amp; 0 &amp; 0 &amp; 1.0 &amp; 0 &amp; 0 &amp; -1.0 &amp; 1.0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 1.0 &amp; 0 &amp; 0.5 &amp; -1.0 &amp; 0.5\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1.0 &amp; 0 &amp; 1.0 &amp; -1.0\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<p>Vamos la estructura que tiene la matriz A ploteandola con la función <code class="docutils literal notranslate"><span class="pre">spy</span></code> del módulo <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">spy</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Estructura de la matriz A&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/30c0a13dcee5c80e207eaae9204d2242ff3939037360dd902b87ce5715442829.png" src="../_images/30c0a13dcee5c80e207eaae9204d2242ff3939037360dd902b87ce5715442829.png" />
</div>
</div>
<p>Creemos la matriz <span class="math notranslate nohighlight">\(R\)</span> que contiene parte de las condiciones de frontera de Neumann no homogéneas que definen el flujo entrante de agua por la parte superior del dominio:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">creating_matrix_R</span><span class="p">(</span><span class="n">Nx</span><span class="p">,</span> <span class="n">Ny</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">D</span><span class="p">):</span>
    <span class="c1"># Crear vector completo de ceros</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Nx</span> <span class="o">*</span> <span class="n">Ny</span><span class="p">)</span>
    <span class="c1"># Sustituir a partir del segundo bloque hasta el penúltimo, el último</span>
    <span class="c1"># elemento con el valor del flujo de las condiciones de fronteras</span>
    <span class="c1"># de Nuemann.</span>
    <span class="n">R</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Nx</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">Nx</span> <span class="o">*</span> <span class="n">Ny</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">Nx</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">r</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">D</span>

    <span class="k">return</span> <span class="n">spdiags</span><span class="p">([</span><span class="n">R</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Nx</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">Ny</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Con el uso de <code class="docutils literal notranslate"><span class="pre">Sympy</span></code> podemos visualizarlos en este ejemplo reducido</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R</span> <span class="o">=</span> <span class="n">creating_matrix_R</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="n">sy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">todense</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; -0.02 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<p>Si observamos la estructura de esta matriz veremos que solo tiene valores distintos de cero en su diagonal y muy esparcidos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">spy</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Estructura de la matriz R&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5e19ff6e137f60cb4fb2a680ffed07143eebe014cde3196c493563ccb805db96.png" src="../_images/5e19ff6e137f60cb4fb2a680ffed07143eebe014cde3196c493563ccb805db96.png" />
</div>
</div>
<p>La estructura de la matriz <span class="math notranslate nohighlight">\((A + R)\)</span> sigue siendo la misma pero con la adición de las valores de <span class="math notranslate nohighlight">\(R\)</span> en los lugares correspondientes de la diagonal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">((</span><span class="n">A</span> <span class="o">+</span> <span class="n">R</span><span class="p">)</span><span class="o">.</span><span class="n">todense</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}-1.0 &amp; 1.0 &amp; 0 &amp; 1.0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0.5 &amp; -1.0 &amp; 0.5 &amp; 0 &amp; 1.0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 1.0 &amp; -1.0 &amp; 0 &amp; 0 &amp; 1.0 &amp; 0 &amp; 0 &amp; 0\\0.5 &amp; 0 &amp; 0 &amp; -1.0 &amp; 1.0 &amp; 0 &amp; 0.5 &amp; 0 &amp; 0\\0 &amp; 0.5 &amp; 0 &amp; 0.5 &amp; -1.0 &amp; 0.5 &amp; 0 &amp; 0.5 &amp; 0\\0 &amp; 0 &amp; 0.5 &amp; 0 &amp; 1.0 &amp; -1.02 &amp; 0 &amp; 0 &amp; 0.5\\0 &amp; 0 &amp; 0 &amp; 1.0 &amp; 0 &amp; 0 &amp; -1.0 &amp; 1.0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 1.0 &amp; 0 &amp; 0.5 &amp; -1.0 &amp; 0.5\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1.0 &amp; 0 &amp; 1.0 &amp; -1.0\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<p>Como parte del flujo definido en la parte superior del dominio se tiene también estos valores que no son coeficientes de las variables involucradas. Precisamente representa la cantidad de líquido que se está aportando al sistema en el tiempo (<span class="math notranslate nohighlight">\(g\)</span>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">creating_vector_b</span><span class="p">(</span><span class="n">Nx</span><span class="p">,</span> <span class="n">Ny</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
    <span class="c1"># Crear vector completo de ceros</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Nx</span> <span class="o">*</span> <span class="n">Ny</span><span class="p">)</span>
    <span class="c1"># Sustituir a partir del segundo bloque hasta el penúltimo, el último</span>
    <span class="c1"># elemento con el valor del flujo de las condiciones de fronteras</span>
    <span class="c1"># de Nuemann.</span>
    <span class="n">b</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Nx</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">Nx</span> <span class="o">*</span> <span class="n">Ny</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">Nx</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">r</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">D</span> <span class="o">*</span> <span class="n">g</span>
    <span class="k">return</span> <span class="n">b</span>
</pre></div>
</div>
</div>
</div>
<p>Igualmente se puede visualizar con el módulo <code class="docutils literal notranslate"><span class="pre">Sympy</span></code>. Esta vez es un vector.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">creating_vector_b</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">sy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}0\\0\\0\\0\\0\\0.04\\0\\0\\0\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<p>Ahora realicemos el ejemplo con dimensiones más grandes y veamos que sucede. El flujo de entrada está diseñado para que sea constante durante <span class="math notranslate nohighlight">\(0.3\)</span> minutos y luego nulo. Veamos que es lo que sucede.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">folder_name</span> <span class="o">=</span> <span class="s2">&quot;Infiltration&quot;</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">folder_name</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">FileExistsError</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">gfun</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
            <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Nx</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Nx</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="p">))</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Nx</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>


<span class="c1"># Coeficiente de almacenamiento [-]</span>
<span class="n">S</span> <span class="o">=</span> <span class="mf">5e-5</span>
<span class="c1"># Espesor   [m]</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="c1"># Conductividad Hidráulica  [m/day] --&gt; [m/s]</span>
<span class="n">K</span> <span class="o">=</span> <span class="mf">1e-1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">24</span> <span class="o">*</span> <span class="mi">3600</span><span class="p">)</span>
<span class="c1"># infiltración del flujo de agua en la superficie [m/s]</span>
<span class="n">fg</span> <span class="o">=</span> <span class="mf">1e-4</span>

<span class="c1"># Coeficiente de difusión</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">K</span> <span class="o">*</span> <span class="n">mu</span> <span class="o">/</span> <span class="n">S</span>

<span class="n">r</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">dx</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">dy</span> <span class="o">=</span> <span class="mf">0.1</span>

<span class="n">Nx</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">Ny</span> <span class="o">=</span> <span class="mi">50</span>

<span class="n">dx</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">dy</span> <span class="o">=</span> <span class="mf">0.1</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Nx</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Ny</span><span class="p">)</span>

<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">gfun</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

<span class="n">u_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Nx</span><span class="p">,</span> <span class="n">Ny</span><span class="p">))</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="n">dt</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">dx</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">D</span>  <span class="c1"># CFL - Condition</span>

<span class="n">t</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">8000</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">Creating_Matrix_A</span><span class="p">(</span><span class="n">Nx</span><span class="p">,</span> <span class="n">Ny</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">creating_matrix_R</span><span class="p">(</span><span class="n">Nx</span><span class="p">,</span> <span class="n">Ny</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">creating_vector_b</span><span class="p">(</span><span class="n">Nx</span><span class="p">,</span> <span class="n">Ny</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">+=</span> <span class="n">dt</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">gfun</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">creating_vector_b</span><span class="p">(</span><span class="n">Nx</span><span class="p">,</span> <span class="n">Ny</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>

    <span class="n">u_n</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="n">R</span><span class="p">)</span> <span class="o">*</span> <span class="n">u_n</span> <span class="o">+</span> <span class="n">b</span>

    <span class="n">Z</span> <span class="o">=</span> <span class="n">u_n</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">Nx</span><span class="p">,</span> <span class="n">Ny</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">k</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">cm_size</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mf">2.54</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span>
            <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">40</span> <span class="o">*</span> <span class="n">cm_size</span><span class="p">,</span> <span class="mi">23</span> <span class="o">*</span> <span class="n">cm_size</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;3d&quot;</span><span class="p">)</span>

        <span class="n">surf</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span>
            <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">gist_earth</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">antialiased</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span>
        <span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="mi">75</span><span class="p">,</span> <span class="mi">230</span><span class="p">)</span>
        <span class="c1"># plt.draw()</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;prof&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_zlim3d</span><span class="p">([</span><span class="mf">1e-10</span><span class="p">,</span> <span class="mf">4e-8</span><span class="p">])</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
            <span class="s2">&quot;Infiltración de agua en grava (2D)</span><span class="se">\n</span><span class="s2">t=</span><span class="si">{}</span><span class="s2"> min, D=</span><span class="si">{}</span><span class="s2"> $m^2/s$, dx=</span><span class="si">{}</span><span class="s2"> $m$, dt=</span><span class="si">{}</span><span class="s2"> $s$</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">r</span><span class="s2">&quot;S=</span><span class="si">{}</span><span class="s2"> [-], K=</span><span class="si">{}</span><span class="s2"> $m/s$, g=</span><span class="si">{}</span><span class="s2"> $m/s$, $\mu=$</span><span class="si">{}</span><span class="s2"> m&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                <span class="n">np</span><span class="o">.</span><span class="n">format_float_scientific</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                <span class="n">dx</span><span class="p">,</span>
                <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                <span class="n">np</span><span class="o">.</span><span class="n">format_float_scientific</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                <span class="n">np</span><span class="o">.</span><span class="n">format_float_scientific</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                <span class="n">np</span><span class="o">.</span><span class="n">format_float_scientific</span><span class="p">(</span><span class="n">fg</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                <span class="n">mu</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;Infiltration/time_</span><span class="si">%05d</span><span class="s2">.png&quot;</span> <span class="o">%</span> <span class="n">k</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c1"># print(&quot;time =&quot;, t)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="ejercicios-de-la-clase">
<h1>Ejercicios de la clase<a class="headerlink" href="#ejercicios-de-la-clase" title="Link to this heading">#</a></h1>
<section id="ejercicio-1-calculando-funcion-en-3d">
<h2>Ejercicio #1: Calculando función en 3D.<a class="headerlink" href="#ejercicio-1-calculando-funcion-en-3d" title="Link to this heading">#</a></h2>
<p>En este ejercicio usted deberá de implementar el método <code class="docutils literal notranslate"><span class="pre">fro</span></code> el cual se encuentra en blanco debajo. Este método calcula la función <span class="math notranslate nohighlight">\(\text{fro}\)</span> en el dominio <span class="math notranslate nohighlight">\(x, y \in [-1, 1]\times[-1, 1]\)</span> tal que</p>
<p><span class="math notranslate nohighlight">\(fro(x, y) = \frac{\left|\left(x^2 - 1\right)\left(y^2 - 1\right)\right|}{x^2 + y^2 + 1}\)</span>.</p>
<p>Pasos para la resolución del ejercicio:</p>
<ol class="arabic simple">
<li><p>Crear una rejilla que discretize el dominio <span class="math notranslate nohighlight">\([-1, 1]\times[-1, 1]\)</span>.</p></li>
<li><p>Implementar la función en el método <code class="docutils literal notranslate"><span class="pre">fro</span></code>.</p></li>
<li><p>Vectorizar el método <code class="docutils literal notranslate"><span class="pre">fro</span></code> y calcular los valores para cada elemento de la rejilla (matriz <code class="docutils literal notranslate"><span class="pre">Z</span></code>).</p></li>
<li><p>Utilizar el método llamado <code class="docutils literal notranslate"><span class="pre">plotea</span></code> proporcionado para mostrar el resultado.</p></li>
</ol>
<p>¡El método <code class="docutils literal notranslate"><span class="pre">plotea</span></code> ya está hecho! No tiene que modificar nada en él.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plotea</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">):</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;3d&quot;</span><span class="p">)</span>

    <span class="n">surf</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">rainbow</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">antialiased</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span> <span class="mi">230</span><span class="p">)</span>
    <span class="c1"># plt.draw()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Y&quot;</span><span class="p">)</span>
    <span class="c1"># ax.set_zlim3d([1e-10, 4e-8])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Función FRO&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Función <code class="docutils literal notranslate"><span class="pre">fro</span></code> que deberá de implementar</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fro</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">Y</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
<p>Código principal del ejercicio. Solo tiene que seguir las instrucciones de los comentarios.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Crear una rejilla. Nota: usar la función ```np.meshgrid``` para ello.</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># Obtener una versión vectorizada de la función ```fro```.</span>
<span class="n">fro</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">fro</span><span class="p">)</span>

<span class="c1"># Calcular la matriz Z evaluando la rejilla en la función ```fro```.</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">fro</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>

<span class="c1"># Ejecutar la función ```plotea``` con la rejilla y la matriz Z</span>
<span class="n">plotea</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/7e52dcfc03095e0ab5ec3e439a147a3cab67e6fc1ca439388564bf60c9051130.png" src="../_images/7e52dcfc03095e0ab5ec3e439a147a3cab67e6fc1ca439388564bf60c9051130.png" />
</div>
</div>
</section>
<section id="ejercicio-2">
<h2>Ejercicio #2:<a class="headerlink" href="#ejercicio-2" title="Link to this heading">#</a></h2>
<p>Implemente los métodos <code class="docutils literal notranslate"><span class="pre">create_A</span></code> y <code class="docutils literal notranslate"><span class="pre">create_B_hat</span></code> correspondientes a la implementación del método de Crank Nicolson para la resolución del problema de Poison con condiciones de frontera de Dirichlet homogéneas y las condiciones iniciales que se especifican a continuación.</p>
<p>El problema se define de la siguiente manera:</p>
<p>Sean <span class="math notranslate nohighlight">\(x, y \in \bar{\Omega}([-1, 1]\times[-1, 1])\)</span> y <span class="math notranslate nohighlight">\(t \in [0, T)\)</span> tales que se cumple</p>
<p><span class="math notranslate nohighlight">\(\dfrac{\partial u}{\partial t} - D \Delta u = 0\)</span></p>
<p><span class="math notranslate nohighlight">\(u(t=0, x, y) = \frac{\left|\left(x^2 - 1\right)\left(y^2 - 1\right)\right|}{x^2 + y^2 + 1},\, ∀ x, y \in \Omega\)</span></p>
<p><span class="math notranslate nohighlight">\(u(t &gt; 0, x, y) = 0, \, ∀ x, y \in \partial \Omega\)</span></p>
<p>El método de Crank Nicolson es un método implícito en el cual se utiliza un parámetro <span class="math notranslate nohighlight">\(\Theta = 1/2\)</span> que describe una regla de los trapecios en el tiempo para realizar una integración temporal de segundo orden. En el caso del espacio también utiliza un esquema de diferencias centradas que es de segundo orden. Este método a diferencia del anterior es incondicionalmente estable por lo que es adecuado para problemas grandes o de larga simulación temporal porque brinda más posibilidades de escoger un <span class="math notranslate nohighlight">\(dt\)</span> más grande.</p>
<p>La forma matricial de este método pudiera definirse de la siguiente forma:</p>
<p><span class="math notranslate nohighlight">\(u^{n+1} = A^{-1} (\hat{B} \, u^n)\)</span></p>
<p>Al ser <span class="math notranslate nohighlight">\(A_{Nx\times Ny}\)</span> y <span class="math notranslate nohighlight">\(\hat{B}_{Nx\times Ny}\)</span> matrices <em>sparse</em> se utiliza la función <code class="docutils literal notranslate"><span class="pre">scipy.sparse.linalg.spsolve</span></code>. El vector <span class="math notranslate nohighlight">\(u^n\)</span> continua siendo el mismo descrito en el ejemplo #1 de la clase.</p>
<p>Las matrices se definen de la siguiente manera</p>
<p><span class="math notranslate nohighlight">\(A= \begin{bmatrix}
L               &amp;  -\frac{r}{2} I  &amp;                 &amp;       \\
-\frac{r}{2} I  &amp; L                &amp; -\frac{r}{2} I  &amp;       \\
                &amp; \ddots           &amp; \ddots          &amp; \ddots  \\
                &amp;                  &amp; -\frac{r}{2} I &amp; L &amp; -\frac{r}{2} I\\
                &amp;                 &amp;                 &amp; -\frac{r}{2} I &amp; L
\end{bmatrix}\)</span></p>
<p>y</p>
<p><span class="math notranslate nohighlight">\(\hat{B}= \begin{bmatrix}
Q               &amp;  \frac{r}{2} I  &amp;                 &amp;       \\
\frac{r}{2} I  &amp; Q                &amp; \frac{r}{2} I  &amp;       \\
                &amp; \ddots           &amp; \ddots          &amp; \ddots  \\
                &amp;                  &amp; \frac{r}{2} I &amp; Q &amp; \frac{r}{2} I\\
                &amp;                 &amp;                 &amp; \frac{r}{2} I &amp; Q
\end{bmatrix}\)</span>,</p>
<p>donde</p>
<p><span class="math notranslate nohighlight">\(L = \begin{bmatrix}
1 + 2r       &amp; -\frac{r}{2}  &amp;              &amp;        &amp;\\
-\frac{r}{2} &amp; 1 + 2r        &amp; -\frac{r}{2} &amp;        &amp;\\
             &amp; \ddots        &amp; \ddots       &amp; \ddots &amp;\\
             &amp;               &amp; -\frac{r}{2} &amp; 1 + 2r &amp; -\frac{r}{2}\\
             &amp;              &amp;               &amp; -\frac{r}{2} &amp; 1+2r
\end{bmatrix}\)</span></p>
<p><span class="math notranslate nohighlight">\(Q = \begin{bmatrix}
1 - 2r       &amp; \frac{r}{2}  &amp;              &amp;        &amp;\\
\frac{r}{2} &amp; 1 - 2r        &amp; \frac{r}{2} &amp;        &amp;\\
             &amp; \ddots        &amp; \ddots       &amp; \ddots &amp;\\
             &amp;               &amp; \frac{r}{2} &amp; 1 - 2r &amp; \frac{r}{2}\\
             &amp;              &amp;               &amp; \frac{r}{2} &amp; 1-2r
\end{bmatrix}\)</span></p>
<p>El código que verá a continuación ya está pre-hecho. Solo usted deberá de escribir el código que genere las matrices <span class="math notranslate nohighlight">\(A\)</span> y <span class="math notranslate nohighlight">\(\hat{B}\)</span>.</p>
<p>Creando la matriz <span class="math notranslate nohighlight">\(A\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_A</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="n">diag_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">N</span> <span class="o">*</span> <span class="n">N</span><span class="p">),</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">r</span><span class="p">)</span>

    <span class="n">diag1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">r</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">))),</span> <span class="n">N</span><span class="p">)</span>
    <span class="n">diag_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">r</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">]))),</span> <span class="n">N</span><span class="p">)</span>

    <span class="n">diag_N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">N</span> <span class="o">*</span> <span class="n">N</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">r</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">spdiags</span><span class="p">(</span>
        <span class="p">[</span><span class="n">diag_N</span><span class="p">,</span> <span class="n">diag_1</span><span class="p">,</span> <span class="n">diag_0</span><span class="p">,</span> <span class="n">diag1</span><span class="p">,</span> <span class="n">diag_N</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">N</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">],</span> <span class="n">N</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="o">**</span><span class="mi">2</span>
    <span class="p">)</span><span class="o">.</span><span class="n">tocsr</span><span class="p">()</span>


<span class="n">A</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">create_A</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">todense</span><span class="p">())</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{array}{ccccccccccccccccccccccccc}2.0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\-0.25 &amp; 2.0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; -0.25 &amp; 2.0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; -0.25 &amp; 2.0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 2.0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\-0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 2.0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 2.0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 2.0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 2.0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 2.0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 2.0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 2.0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 2.0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 2.0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 2.0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 2.0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 2.0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 2.0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 2.0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 2.0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 2.0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 2.0 &amp; -0.25 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 2.0 &amp; -0.25 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 2.0 &amp; -0.25\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 0 &amp; 0 &amp; 0 &amp; -0.25 &amp; 2.0\end{array}\right]\end{split}\]</div>
</div>
</div>
<p>Creando la matriz <span class="math notranslate nohighlight">\(\hat{B}\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_B_hat</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="n">diag_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">N</span> <span class="o">*</span> <span class="n">N</span><span class="p">),</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">r</span><span class="p">)</span>

    <span class="n">diag1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,),</span> <span class="n">r</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">))),</span> <span class="n">N</span><span class="p">)</span>
    <span class="n">diag_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,),</span> <span class="n">r</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">]))),</span> <span class="n">N</span><span class="p">)</span>

    <span class="n">diag_N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">N</span> <span class="o">*</span> <span class="n">N</span><span class="p">),</span> <span class="n">r</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">spdiags</span><span class="p">(</span>
        <span class="p">[</span><span class="n">diag_N</span><span class="p">,</span> <span class="n">diag_1</span><span class="p">,</span> <span class="n">diag_0</span><span class="p">,</span> <span class="n">diag1</span><span class="p">,</span> <span class="n">diag_N</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">N</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">],</span> <span class="n">N</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="o">**</span><span class="mi">2</span>
    <span class="p">)</span><span class="o">.</span><span class="n">tocsr</span><span class="p">()</span>


<span class="n">B_hat</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">create_B_hat</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">todense</span><span class="p">())</span>
<span class="n">B_hat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{array}{ccccccccccccccccccccccccc}0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0.25 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0.25 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0.25 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0.25\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0 &amp; 0 &amp; 0 &amp; 0.25 &amp; 0\end{array}\right]\end{split}\]</div>
</div>
</div>
<p>Función <span class="math notranslate nohighlight">\(u(x, y) = \frac{\left|\left(x^2 - 1\right)\left(y^2 - 1\right)\right|}{x^2 + y^2 + 1}\)</span> utilizada para inicializar el dominio en el <span class="math notranslate nohighlight">\(t=0\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fro</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">Y</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Código principal del ejercicio. El único cambio que usted debe realizar es la dirección en donde desea salvar los png resultantes.</p>
<p>Solo tiene que poner la dirección correcta y completa de la carpeta local en su computadora, como un string en la variable</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Modificar la dirección de salva !!!</span>
<span class="n">folder_name</span> <span class="o">=</span> <span class="s2">&quot;PeC3&quot;</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">folder_name</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">FileExistsError</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Vectorizando la función de mcondiciones iniciales</span>
<span class="n">fro</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">fro</span><span class="p">)</span>

<span class="c1"># Discretización del dominio</span>

<span class="n">dx</span> <span class="o">=</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mf">5.0</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span>

<span class="n">Nx</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Ny</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">XX</span><span class="p">,</span> <span class="n">YY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># Coeficiente de estabilización (CFL)</span>
<span class="n">r</span> <span class="o">=</span> <span class="mf">0.25</span>

<span class="c1"># Coeficiente de difusión</span>
<span class="n">D</span> <span class="o">=</span> <span class="mf">1e-3</span>

<span class="c1"># Calculando dt</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">dx</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">D</span>

<span class="c1"># Tiempo inicial</span>
<span class="n">t</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="c1"># Tiempo total</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">77</span>

<span class="c1"># Inicialización de variable para condiciones iniciales.</span>
<span class="c1"># Las fronteras serán iguales a cero</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Nx</span><span class="p">,</span> <span class="n">Ny</span><span class="p">))</span>

<span class="c1"># Aplicar función de condiciones iniciales a u</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">fro</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span> <span class="n">YY</span><span class="p">)</span> <span class="o">*</span> <span class="mf">200.0</span>

<span class="c1"># Crear matriz A</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">create_A</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Crear matriz B sombrero</span>
<span class="n">B_hat</span> <span class="o">=</span> <span class="n">create_B_hat</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Ciclo principal</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
    <span class="c1"># Convertir u de 2D a 1D usando función aplanar (flatten)</span>
    <span class="n">u_flat</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

    <span class="c1"># Creando vector de carga (load vector en inglés)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">B_hat</span> <span class="o">*</span> <span class="n">u_flat</span>

    <span class="c1"># Resolución del sistema de ecuaciones para matrices sparse.</span>
    <span class="c1"># Se obtiene la nueva solución en el timepo t + dt * k</span>
    <span class="n">u_flat</span> <span class="o">=</span> <span class="n">spsolve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

    <span class="c1"># Convertir u de 1D a 2D nuevamente</span>
    <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">u_flat</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span>

    <span class="c1"># Avanzar en el tiempo</span>
    <span class="n">t</span> <span class="o">+=</span> <span class="n">k</span> <span class="o">*</span> <span class="n">dt</span>

    <span class="c1"># Plotear solución y salvarla como png</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
    <span class="n">cb</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
        <span class="n">XX</span><span class="p">,</span> <span class="n">YY</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span> <span class="o">+</span> <span class="n">dt</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Y&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cb</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;t</span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">t</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/time_</span><span class="si">%05d</span><span class="s2">.png&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">folder_name</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./intro_python"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="numpy_a.html"
       title="página anterior">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">anterior</p>
        <p class="prev-next-title">Manejo de vectores y matrices en Python: Módulo Numpy Parte 1</p>
      </div>
    </a>
    <a class="right-next"
       href="linear_algebra.html"
       title="siguiente página">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">siguiente</p>
        <p class="prev-next-title">Álgebra Lineal</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contenido
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Manejo de vectores y matrices en Python: Módulo NumPy Parte 2</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generando-matrices">Generando Matrices</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vistas-de-vectores">Vistas de vectores</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#indexacion-avanzada">Indexación avanzada</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reconfiguracion-y-redimensionalizacion-de-vectores">Reconfiguración y redimensionalización de vectores</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vectorizacion-de-funciones-y-operadores">Vectorización de funciones y operadores</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ejemplo-1-infiltracion-de-agua-en-el-suelo">Ejemplo #1: Infiltración de Agua en el suelo.</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ejercicios-de-la-clase">Ejercicios de la clase</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ejercicio-1-calculando-funcion-en-3d">Ejercicio #1: Calculando función en 3D.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ejercicio-2">Ejercicio #2:</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
Por Carlos Aznarán
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>